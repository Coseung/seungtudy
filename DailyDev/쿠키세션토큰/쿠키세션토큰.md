쿠키 세션 토큰 차이 누가 모름? 
의 "누"를 담당하고 있습니다. 간단하게 쿠키와 세션 그리고 토큰 방식에 대해 공부한 것을 정리 하였습니다.

## HTTP 통신 
클라이언트 ↔ 서버 통신은 기본적으로

- 클라이언트가 요청

- 서버가 응답

- 서버는 응답하고 연결을 종료

즉 서버 입장에서는 이전 요청에서 **누가 왔는지**를 기억하지 않는 게 기본입니다.
이걸 **Stateless** 하다고 하죠.


그래서 서버가 인증 상태를 유지하지 않으면, 이론상 클라이언트는 요청할 때마다
![](https://velog.velcdn.com/images/dreamdp01/post/2b74a0ed-1ee4-4673-86d8-2c0f36ff5c31/image.jpg)


>“나 누구임”

>“비번 뭐임”

이걸 매번 다시 보내야 합니다.
상태를 이어주는 장치가 필요해지고, 그게 **쿠키/세션/토큰**입니다.

---
## 쿠키(Cookie)
![](https://velog.velcdn.com/images/dreamdp01/post/e300f005-6d8f-4fad-806a-30dd4ac66ea4/image.png)

쿠키는 서버가 웹 브라우저에 내려주는 **key-value** 형태의 데이터입니다.

특징은 
- 브라우저에 저장됨
- 같은 서버로 요청할 때마다 쿠키를 같이 보냄

![](https://velog.velcdn.com/images/dreamdp01/post/f8c18ea3-8ec8-428e-9ed3-f32b170c04d3/image.png)



#### 쿠키에 담을 수 있는 것들 예시

- 유저 정보
- 언어 설정
- 사이트 이용 정보
- 도메인, 경로 같은 설정값

####  이런 데 많이 씁니다
![](https://velog.velcdn.com/images/dreamdp01/post/234d48dc-2f95-400e-a331-2487fe246d56/image.png)

- 일주일간 보지 않기
- 자동 로그인
- 장바구니
- 저장하기

#### 근데 단점도 명확합니다.

- 보안에 취약함 (탈취 가능)
- 용량이 작음 (대략 4KB 수준)
![](https://velog.velcdn.com/images/dreamdp01/post/fd2933cc-84fa-4865-be41-24184b613506/image.png)


---

## 세션(Session)

세션은 **쿠키** 기반 인증 방식입니다.  


흐름은 보통 이렇게 됩니다.

![](https://velog.velcdn.com/images/dreamdp01/post/9ec1d775-3ae4-4a58-b5c8-b76560647f4d/image.png)



1. 클라이언트가 로그인 요청
2. 서버가 로그인 정보 확인
3. 서버가 세션 저장소에 사용자 정보를 저장
4. 서버가 Session ID를 쿠키에 담아 클라이언트에 내려줌
5. 이후 요청부터는 쿠키로 사용자를 식별

**차이점**은 쿠키는 **클라이언트에 유저 정보를 저장**하고 세션은 중요한 정보를 서버에 있는 **Session DB에 저장** 하고 쿠키에는 Session ID 만 주는 것이죠 


#### 장점 
- 쿠키가 탈취돼도 그 안에 유저정보가 들어있진 않음
- 서버에서 세션 끊으면 강제 로그아웃 가능

#### 단점, 한계점
- 로그인 유저가 많아지면 서버 메모리, 저장소 부담 증가
- Stateful 해짐 (서버가 상태를 들고 있음)
- 요청마다 Session DB 조회 → 부하
- 쿠키를 가로채서 보내면 서버는 인증된 사용자로 볼 수도 있음  
  
![](https://velog.velcdn.com/images/dreamdp01/post/fa79b4df-fc0e-4b70-9d03-43f204c5b63b/image.png)  


---
## 토큰(Token) / JWT

토큰은 사용자를 인증하거나 인가할 때 쓰는 작은 데이터 조각입니다.  
요즘 가장 많이 쓰는 건 JWT죠.

![](https://velog.velcdn.com/images/dreamdp01/post/4a7c00dc-bc11-485e-9a08-761542440cee/image.png)
![](https://velog.velcdn.com/images/dreamdp01/post/dc509551-1ba9-4fec-8cda-a35b5f53657b/image.jpg)


JWT의 핵심은 세션이랑 반대입니다.

- 서버가 DB에 인증 상태를 저장하지 않음
- 토큰 자체에 필요한 정보가 들어있고
- 서버는 요청 들어올 때마다 토큰을 검증해서 지금 얘가 누구인지 판단



흐름은 다음과 같습니다.
![](https://velog.velcdn.com/images/dreamdp01/post/25787b0b-ed76-472f-b2e7-5e12ef7b9360/image.png)

1. 로그인 성공
2. 서버가 JWT 발급 (서명, 암호화에 비밀키 사용)
3. 클라이언트가 JWT 저장
4. 매 요청마다 JWT를 HTTP Header에 담아 전송
5. 서버는 JWT 검증, 해독해서 인증 + 권한 판단

JWT의 안에는 다음과 같이
![](https://velog.velcdn.com/images/dreamdp01/post/6ec15724-287a-488e-ba86-7abf2fe87bfa/image.png)

헤더, 페이로드, 서명 으로 나누어져있고 JWT 토큰의 응답은 사진 에서 왼쪽과 같이 
헤더.페이로드.서명 을 암호화된 코드로 받을 수 있다


### JWT 한계

- **Token Size 문제**  
  페이로드가 커질수록 전송 비용이 계속 커짐  
  → 필요하면 압축, 최적화 고민해야 함

- **탈취 위험 ** 
  JWT가 털리면 그 JWT가 만료될 때까지 악용될 수 있음  
  → 만료시간을 적절히 짧게 잡고, 필요한 경우 추가 리프레시 토큰도 고려해야 함



---

## 마무리

HTTP가 기본적으로 Stateless라서,  
인증 상태를 유지하려면 뭔가를 얹어야 하고

- 쿠키는 가볍지만 보안, 용량이 약하고
- 세션은 서버가 편하지만 확장성, 부하 문제가 있고
- 토큰(JWT)은 서버가 가벼워지지만 탈취, 크기 문제를 신경써야 합니다.

